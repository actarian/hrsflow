{"version":3,"names":[],"mappings":"","sources":["src/app/app.js"],"sourcesContent":["/* jshint esversion: 6 */\n/* global window, document, Swiper, TweenMax */\n\nimport Dom from './shared/dom';\nimport Rect from './shared/rect';\nimport Triangles from './shared/triangles';\n\nexport default class App {\n\n\tconstructor() {}\n\n\tinit() {\n\t\tconst body = document.querySelector('body');\n\t\tconst page = document.querySelector('.page');\n\t\tconst swiperHero = new Swiper('.swiper-container--home-hero', {\n\t\t\tloop: true,\n\t\t\t// effect: 'fade',\n\t\t\t// followFinger: true,\n\t\t\tparallax: true,\n\t\t\tspaceBetween: 0,\n\t\t\tspeed: 600,\n\t\t\tautoplay: {\n\t\t\t\tdelay: 5000,\n\t\t\t\tdisableOnInteraction: true,\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tslideChangeTransitionEnd: function() {\n\t\t\t\t\t// console.log('slideChange', this.slides.length, this.activeIndex);\n\t\t\t\t\tconst slide = this.slides[this.activeIndex];\n\t\t\t\t\tif (slide) {\n\t\t\t\t\t\tconst video = slide.querySelector('video');\n\t\t\t\t\t\t/*\n\t\t\t\t\t\tconst videos = [].slice.call(slide.parentNode.querySelectorAll('video'));\n\t\t\t\t\t\tvideos.forEach(function(v) {\n\t\t\t\t\t\t\tif (!video && !!(v.currentTime > 0 && !v.paused && !v.ended && v.readyState > 2)) {\n\t\t\t\t\t\t\t\tv.pause();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tif (video) {\n\t\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t\t\tconsole.log(video);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// console.log(videos);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\t/*\n\t\t\tpagination: {\n\t\t\t\tel: '.swiper-pagination',\n\t\t\t\tclickable: true,\n\t\t\t\tdynamicBullets: true,\n\t\t\t},\n\t\t\t*/\n\t\t});\n\t\tconst swiperHilights = new Swiper('.swiper-container--hilights', {\n\t\t\tloop: false,\n\t\t\t/*\n\t\t\tmousewheel: {\n\t\t\t\tinvert: true,\n\t\t\t},\n\t\t\t*/\n\t\t\tparallax: true,\n\t\t\tspaceBetween: 300,\n\t\t\tspeed: 600,\n\t\t\tpagination: {\n\t\t\t\tel: '.swiper-pagination',\n\t\t\t\tclickable: true,\n\t\t\t\tdynamicBullets: true,\n\t\t\t},\n\t\t});\n\t\tconst shadows = [].slice.call(document.querySelectorAll('[data-parallax-shadow]'));\n\t\tconst animations = [].slice.call(document.querySelectorAll('.triangles')).map((element) => {\n\t\t\treturn new Triangles(element);\n\t\t});\n\t\tconst elements = [].slice.call(document.querySelectorAll('.case-studies__item'));\n\t\tconst hrefs = [].slice.call(document.querySelectorAll('[href=\"#\"]'));\n\t\tconst mxy = { x: 0, y: 0 };\n\t\tthis.body = body;\n\t\tthis.page = page;\n\t\tthis.swiperHero = swiperHero;\n\t\tthis.swiperHilights = swiperHilights;\n\t\tthis.shadows = shadows;\n\t\tthis.animations = animations;\n\t\tthis.elements = elements;\n\t\tthis.hrefs = hrefs;\n\t\tthis.mxy = mxy;\n\t\twindow.addEventListener('resize', () => {\n\t\t\tthis.resize();\n\t\t});\n\t\twindow.addEventListener('scroll', () => {\n\t\t\tthis.scroll();\n\t\t});\n\t\tdocument.addEventListener('mousemove', (e) => {\n\t\t\tthis.mxy.x = e.clientX / window.innerWidth - 0.5;\n\t\t\tthis.mxy.y = e.clientY / window.innerHeight - 0.5;\n\t\t});\n\t\threfs.forEach((element) => {\n\t\t\telement.addEventListener('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t});\n\t\t/*\n\t\tconst intersection = new IntersectionService();\n\t\telements.forEach((element, i) => intersection.observe(element, (entry, ei) => {\n\t\t\tlet pow = 1 + 0.1 * i;\n\t\t\tpow = (pow * entry.intersectionRatio);\n\t\t\telement.pow = pow;\n\t\t}));\n\t\t*/\n\t\tthis.resize();\n\t\tthis.loop();\n\t}\n\n\trender() {\n\t\t// smoothscroll\n\t\tif (this.body.offsetHeight !== this.page.offsetHeight) {\n\t\t\tTweenMax.set(this.body, {\n\t\t\t\theight: this.page.offsetHeight,\n\t\t\t});\n\t\t}\n\t\tlet cy = this.page.cy || 0;\n\t\tcy += (-window.scrollY - cy) / 10;\n\t\tthis.page.cy = cy;\n\t\tTweenMax.set(this.page, {\n\t\t\ty: cy,\n\t\t});\n\t\t// shadows\n\t\tthis.shadows.forEach((element) => {\n\t\t\tconst xy = element.xy || { x: 0, y: 0 };\n\t\t\txy.x += (this.mxy.x - xy.x) / 8;\n\t\t\txy.y += (this.mxy.y - xy.y) / 8;\n\t\t\tconst shadow = element.getAttribute('data-parallax-shadow') || 90;\n\t\t\tconst pow = (0.2 + 0.3 * (Math.abs(xy.x) + Math.abs(xy.y)) / 2).toFixed(3);\n\t\t\tconst x = (xy.x * -100).toFixed(2);\n\t\t\tconst y = (xy.y * -50).toFixed(2);\n\t\t\tconst bs = x + 'px ' + y + 'px ' + shadow + 'px -10px rgba(0, 0, 0, ' + pow + ')';\n\t\t\tif (element.bs !== bs) {\n\t\t\t\tTweenMax.set(element, {\n\t\t\t\t\t// transform: 'translateX(' + (xy.x * -4) + '%) translateY(' + (xy.y * -2) + '%)',\n\t\t\t\t\tboxShadow: bs,\n\t\t\t\t});\n\t\t\t\telement.bs = bs;\n\t\t\t}\n\t\t\telement.xy = xy;\n\t\t});\n\t\t// parallax\n\t\t/*\n\t\tthis.elements.forEach((element, i) => {\n\t\t\tif (element.parentNode) {\n\t\t\t\tconst parentRect = element.parentNode.getBoundingClientRect();\n\t\t\t\tconst rect = new Rect({\n\t\t\t\t\ttop: parentRect.top + element.offsetTop,\n\t\t\t\t\tleft: parentRect.left + element.offsetLeft,\n\t\t\t\t\twidth: element.offsetWidth,\n\t\t\t\t\theight: element.offsetHeight,\n\t\t\t\t});\n\t\t\t\tconst intersection = rect.intersection(this.windowRect);\n\t\t\t\telement.intersection = intersection;\n\t\t\t\tTweenMax.set(element, {\n\t\t\t\t\ty: element.intersection.center.y * (100 + 30 * i),\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t/*\n\t\tthis.elements.forEach((element, i) => {\n\t\t\tif (element.intersection) {\n\t\t\t\tlet pow = element.pow || 0;\n\t\t\t\tpow += (element.intersection.center.y - pow) / 10;\n\t\t\t\telement.pow = pow;\n\t\t\t\tTweenMax.set(element, {\n\t\t\t\t\t// opacity: pow,\n\t\t\t\t\t// y: pow * 100,\n\t\t\t\t\ty: element.intersection.center.y * 100,\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\t*/\n\t}\n\n\tloop() {\n\t\tthis.render();\n\t\twindow.requestAnimationFrame(() => {\n\t\t\tthis.loop();\n\t\t});\n\t}\n\n\tresize() {\n\t\tthis.windowRect = new Rect({\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t\twidth: window.innerWidth,\n\t\t\theight: window.innerHeight,\n\t\t});\n\t\tthis.animations.forEach((animation) => {\n\t\t\tanimation.resize();\n\t\t});\n\t}\n\n\tscroll() {\n\t\tif (window.scrollY > 0) {\n\t\t\tDom.addClass(this.body, 'fixed');\n\t\t} else {\n\t\t\tDom.removeClass(this.body, 'fixed');\n\t\t}\n\t\t/*\n\t\tconst wrect = new Rect({\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t\twidth: window.innerWidth,\n\t\t\theight: window.innerHeight,\n\t\t});\n\t\tthis.elements.forEach((element, i) => {\n\t\t\tif (element.parentNode) {\n\t\t\t\tconst parentRect = element.parentNode.getBoundingClientRect();\n\t\t\t\tconst rect = new Rect({\n\t\t\t\t\ttop: parentRect.top + element.offsetTop,\n\t\t\t\t\tleft: parentRect.left + element.offsetLeft,\n\t\t\t\t\twidth: element.offsetWidth,\n\t\t\t\t\theight: element.offsetHeight,\n\t\t\t\t});\n\t\t\t\tconst intersection = rect.intersection(wrect);\n\t\t\t\telement.intersection = intersection;\n\t\t\t}\n\t\t});\n\t\t*/\n\t\t/*\n\t\tTweenMax.to(this.page, 1.650, {\n\t\t\ty: -window.scrollY,\n\t\t\tease: Quad.easeOut,\n\t\t\toverwrite: 'all',\n\t\t});\n\t\t*/\n\t}\n\n}\n\nvar app = new App();\n\nwindow.onload = () => {\n\tapp.init();\n};\n"],"file":"app.js"}