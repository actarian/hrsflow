{"version":3,"names":[],"mappings":"","sources":["src/app/app.js"],"sourcesContent":["/* jshint esversion: 6 */\n/* global window, document, Swiper, TweenMax */\n\nimport Dom from './shared/dom';\nimport Rect from './shared/rect';\nimport Triangles from './shared/triangles';\n\nexport default class App {\n\n\tconstructor() {}\n\n\tinit() {\n\t\tconst body = document.querySelector('body');\n\t\tconst page = document.querySelector('.page');\n\t\tconst swiperHero = new Swiper('.swiper-container--home-hero', {\n\t\t\tloop: true,\n\t\t\t// effect: 'fade',\n\t\t\t// followFinger: true,\n\t\t\tparallax: true,\n\t\t\tspaceBetween: 0,\n\t\t\tspeed: 600,\n\t\t\tautoplay: {\n\t\t\t\tdelay: 5000,\n\t\t\t\tdisableOnInteraction: true,\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tslideChangeTransitionEnd: function() {\n\t\t\t\t\t// console.log('slideChange', this.slides.length, this.activeIndex);\n\t\t\t\t\tconst slide = this.slides[this.activeIndex];\n\t\t\t\t\tif (slide) {\n\t\t\t\t\t\tconst video = slide.querySelector('video');\n\t\t\t\t\t\t/*\n\t\t\t\t\t\tconst videos = [].slice.call(slide.parentNode.querySelectorAll('video'));\n\t\t\t\t\t\tvideos.forEach(function(v) {\n\t\t\t\t\t\t\tif (!video && !!(v.currentTime > 0 && !v.paused && !v.ended && v.readyState > 2)) {\n\t\t\t\t\t\t\t\tv.pause();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tif (video) {\n\t\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t\t\tconsole.log(video);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// console.log(videos);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\t/*\n\t\t\tpagination: {\n\t\t\t\tel: '.swiper-pagination',\n\t\t\t\tclickable: true,\n\t\t\t\tdynamicBullets: true,\n\t\t\t},\n\t\t\t*/\n\t\t});\n\t\tconst swiperHilights = new Swiper('.swiper-container--hilights', {\n\t\t\tloop: false,\n\t\t\t/*\n\t\t\tmousewheel: {\n\t\t\t\tinvert: true,\n\t\t\t},\n\t\t\t*/\n\t\t\tparallax: true,\n\t\t\tspaceBetween: 300,\n\t\t\tspeed: 600,\n\t\t\tpagination: {\n\t\t\t\tel: '.swiper-pagination',\n\t\t\t\tclickable: true,\n\t\t\t\tdynamicBullets: true,\n\t\t\t},\n\t\t});\n\t\tconst shadows = [].slice.call(document.querySelectorAll('[data-parallax-shadow]'));\n\t\tconst triangles = [].slice.call(document.querySelectorAll('.triangles')).map((node, i) => {\n\t\t\tconst triangles = new Triangles(node);\n\t\t\ttriangles.i = i;\n\t\t\treturn triangles;\n\t\t});\n\t\tconst parallaxes = [].slice.call(document.querySelectorAll('[data-parallax]'));\n\t\tconst mxy = { x: 0, y: 0 };\n\t\tthis.body = body;\n\t\tthis.page = page;\n\t\tthis.swiperHero = swiperHero;\n\t\tthis.swiperHilights = swiperHilights;\n\t\tthis.shadows = shadows;\n\t\tthis.triangles = triangles;\n\t\tthis.parallaxes = parallaxes;\n\t\tthis.mxy = mxy;\n\t\tthis.onResize();\n\t\tthis.addListeners();\n\t}\n\n\taddListeners() {\n\n\t\twindow.addEventListener('resize', () => {\n\t\t\tapp.onResize();\n\t\t});\n\n\t\twindow.addEventListener('scroll', () => {\n\t\t\tapp.onScroll();\n\t\t});\n\n\t\tdocument.addEventListener('mousemove', (e) => {\n\t\t\tapp.onMouseMove(e);\n\t\t});\n\n\t\t/*\n\t\t// intersection observer\n\t\tconst intersection = new IntersectionService();\n\t\tparallaxes.forEach((node, i) => intersection.observe(node, (entry, ei) => {\n\t\t\tlet pow = 1 + 0.1 * i;\n\t\t\tpow = (pow * entry.intersectionRatio);\n\t\t\tnode.pow = pow;\n\t\t}));\n\t\t*/\n\n\t\t// href=\"#\" noop\n\t\tconst hrefs = [].slice.call(document.querySelectorAll('[href=\"#\"]'));\n\t\threfs.forEach((node) => {\n\t\t\tnode.addEventListener('click', (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t});\n\t\t});\n\n\t}\n\n\tonMouseMove(e) {\n\t\tthis.mxy.x = e.clientX / window.innerWidth - 0.5;\n\t\tthis.mxy.y = e.clientY / window.innerHeight - 0.5;\n\t}\n\n\tonResize() {\n\t\tthis.windowRect = new Rect({\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t\twidth: window.innerWidth,\n\t\t\theight: window.innerHeight,\n\t\t});\n\t\tthis.triangles.forEach((animation) => {\n\t\t\tanimation.resize();\n\t\t});\n\t}\n\n\tonScroll() {\n\t\tif (Dom.scrollTop() > 0) {\n\t\t\tthis.body.classList.add('fixed');\n\t\t} else {\n\t\t\tthis.body.classList.remove('fixed');\n\t\t}\n\t}\n\n\trender() {\n\n\t\t// smoothscroll\n\t\tif (this.body.offsetHeight !== this.page.offsetHeight) {\n\t\t\tTweenMax.set(this.body, {\n\t\t\t\theight: this.page.offsetHeight,\n\t\t\t});\n\t\t}\n\t\tlet top = this.page.top || 0;\n\t\ttop += (-Dom.scrollTop() - top) / 10;\n\t\ttop = Math.round(top * 10) / 10;\n\t\tif (this.page.top !== top) {\n\t\t\tthis.page.top = top;\n\t\t\tTweenMax.set(this.page, {\n\t\t\t\ty: top,\n\t\t\t});\n\t\t}\n\n\t\t// shadows\n\t\tthis.shadows.forEach((node) => {\n\t\t\tconst xy = node.xy || { x: 0, y: 0 };\n\t\t\txy.x += (this.mxy.x - xy.x) / 8;\n\t\t\txy.y += (this.mxy.y - xy.y) / 8;\n\t\t\tconst shadow = node.getAttribute('data-parallax-shadow') || 90;\n\t\t\tconst alpha = (0.2 + 0.3 * (Math.abs(xy.x) + Math.abs(xy.y)) / 2).toFixed(3);\n\t\t\tconst x = (xy.x * -100).toFixed(2);\n\t\t\tconst y = (xy.y * -50).toFixed(2);\n\t\t\tconst boxShadow = x + 'px ' + y + 'px ' + shadow + 'px -10px rgba(0, 0, 0, ' + alpha + ')';\n\t\t\t// if (node.boxShadow !== boxShadow) {\n\t\t\t// \tnode.boxShadow = boxShadow;\n\t\t\tTweenMax.set(node, {\n\t\t\t\tboxShadow: boxShadow,\n\t\t\t});\n\t\t\t// }\n\t\t\tnode.xy = xy;\n\t\t});\n\n\t\t// triangles\n\t\tthis.triangles.forEach((triangle, i) => {\n\t\t\tconst node = triangle.element;\n\t\t\tlet rect = Rect.fromNode(node);\n\t\t\tconst intersection = rect.intersection(this.windowRect);\n\t\t\tif (intersection.y > 0) {\n\t\t\t\ttriangle.appear();\n\t\t\t} else {\n\t\t\t\ttriangle.disappear();\n\t\t\t}\n\t\t});\n\n\t\t// parallax\n\t\tthis.parallaxes.forEach((node, i) => {\n\t\t\tlet currentY = node.currentY || 0;\n\t\t\tlet rect = Rect.fromNode(node);\n\t\t\trect = new Rect({\n\t\t\t\ttop: rect.top - currentY,\n\t\t\t\tleft: rect.left,\n\t\t\t\twidth: rect.width,\n\t\t\t\theight: rect.height,\n\t\t\t});\n\t\t\tconst intersection = rect.intersection(this.windowRect);\n\t\t\tcurrentY = intersection.center.y * parseInt(node.getAttribute('data-parallax'));\n\t\t\tif (node.currentY !== currentY) {\n\t\t\t\tnode.currentY = currentY;\n\t\t\t\tTweenMax.set(node, {\n\t\t\t\t\ttransform: 'translateY(' + currentY + 'px)',\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t}\n\n\tloop() {\n\t\tthis.render();\n\t\tif (this.playing) {\n\t\t\twindow.requestAnimationFrame(() => {\n\t\t\t\tthis.loop();\n\t\t\t});\n\t\t}\n\t}\n\n\tplay() {\n\t\tthis.playing = true;\n\t\tthis.loop();\n\t}\n\n\tpause() {\n\t\tthis.playing = false;\n\t}\n\n}\n\nvar app = new App();\n\nwindow.onload = () => {\n\tapp.init();\n\tapp.play();\n};\n"],"file":"app.js"}